# 🎯 真实硬编码修复清单

基于手动审查，以下是真正需要修复的硬编码问题。

## 📊 **问题统计**

- **总文件数**: 约20个文件
- **总硬编码数**: 约60个URL
- **问题类型**: 全部是非www版本的URL

## 🔍 **分类和优先级**

### **P0 - 核心配置文件（必须立即修复）**

#### 1. `app/seo-config.ts` - 6个硬编码
```typescript
// 当前（错误）
siteUrl: 'https://periodhub.health',
url: 'https://periodhub.health',
logo: 'https://periodhub.health/logo.png',
url: 'https://periodhub.health',
url: 'https://periodhub.health/og-image.jpg',
images: ['https://periodhub.health/twitter-image.jpg']

// 修复为
siteUrl: 'https://www.periodhub.health',
url: 'https://www.periodhub.health',
logo: 'https://www.periodhub.health/logo.png',
url: 'https://www.periodhub.health',
url: 'https://www.periodhub.health/og-image.jpg',
images: ['https://www.periodhub.health/twitter-image.jpg']
```

#### 2. `lib/seo-config.ts` - 2个硬编码
```typescript
// 当前（错误）
const baseUrl = 'https://periodhub.health';

// 修复为
const baseUrl = 'https://www.periodhub.health';
```

#### 3. `config/site.config.ts` - 1个硬编码
```typescript
// 当前（错误）
? 'https://periodhub.health'

// 修复为
? 'https://www.periodhub.health'
```

### **P1 - 页面组件（影响SEO）**

#### 4. 所有页面组件的canonical URL
- `app/[locale]/medical-disclaimer/page.tsx`
- `app/[locale]/natural-therapies/page.tsx`
- `app/[locale]/privacy-policy/page.tsx`
- `app/[locale]/health-guide/page.tsx`
- `app/[locale]/scenario-solutions/page.tsx`
- `app/[locale]/resources/page.tsx`
- `app/[locale]/pain-tracker/page.tsx`
- `app/[locale]/cultural-charms/page.tsx`
- `app/[locale]/assessment/page.tsx`
- `app/[locale]/special-therapies/page.tsx`
- `app/[locale]/terms-of-service/page.tsx`
- `app/[locale]/interactive-tools/symptom-assessment/page.tsx`
- `app/[locale]/interactive-tools/pain-tracker/page.tsx`
- `app/[locale]/interactive-tools/page.tsx`
- `app/[locale]/teen-health/page.tsx`
- `app/[locale]/immediate-relief/page.tsx`
- `app/[locale]/downloads/page.tsx`

**修复模式**：
```typescript
// 当前（错误）
canonical: `https://periodhub.health/${locale}/page-name`

// 修复为
canonical: `https://www.periodhub.health/${locale}/page-name`
```

### **P2 - 安全配置（可以稍后修复）**

#### 5. `lib/security/csp-config.ts` - 1个硬编码
#### 6. `lib/security/granular-csp-config.ts` - 3个硬编码
#### 7. `lib/seo/keyword-tracker.ts` - 2个硬编码

## 🚀 **修复策略**

### **立即修复（今天）**
1. **核心配置文件** - 修复P0级别的3个文件
2. **建立URL配置中心** - 防止未来硬编码

### **分批修复（本周）**
1. **页面组件** - 修复P1级别的页面组件
2. **安全配置** - 修复P2级别的安全配置

## 💡 **修复方法**

### **方法1：直接替换**
```bash
# 批量替换非www为www
find app/ lib/ config/ -name "*.ts" -o -name "*.tsx" | \
xargs sed -i '' 's/https:\/\/periodhub\.health/https:\/\/www.periodhub.health/g'
```

### **方法2：使用URL配置中心**
```typescript
// 创建 lib/url-config.ts
export const URL_CONFIG = {
  BASE_URL: process.env.NEXT_PUBLIC_BASE_URL || 'https://www.periodhub.health',
  getUrl: (path: string) => `${URL_CONFIG.BASE_URL}${path}`,
  getCanonicalUrl: (path: string) => `${URL_CONFIG.BASE_URL}${path}`
};

// 使用方式
import { URL_CONFIG } from '@/lib/url-config';
const canonical = URL_CONFIG.getCanonicalUrl(`/${locale}/page-name`);
```

## ✅ **验证修复**

```bash
# 检查是否还有非www URL
grep -r "https://periodhub.health" app/ lib/ config/ --include="*.ts" --include="*.tsx" | grep -v "www.periodhub.health"

# 应该返回空结果
```

## 📈 **预期效果**

修复完成后：
- ✅ SEO评分从73分恢复到100分
- ✅ 所有URL统一使用www版本
- ✅ 搜索引擎索引一致性
- ✅ 不再有"越修越多"的问题

## 🎯 **总结**

**真实情况**：
- 只有约20个文件需要修复
- 主要是非www URL问题
- 问题集中，容易修复

**不需要**：
- 复杂的自动化工具
- 大量的误报
- 过度工程化

**需要**：
- 简单的手动修复
- 建立URL配置中心
- 简单的预防措施
