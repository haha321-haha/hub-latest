# 🌍 国际化开发规范

基于项目硬编码修复经验，制定这套完整的国际化开发规范。

## 📋 核心原则

### 1. 禁止硬编码
**永远不要硬编码任何文本内容！**

```typescript
// ❌ 错误 - 硬编码文本
{locale === 'zh' ? '中文内容' : 'English content'}

// ❌ 错误 - 直接中文字符串
const title = '痛经缓解方法';

// ❌ 错误 - 科学参数硬编码
const temperature = '40-45°C (104-113°F)';

// ✅ 正确 - 使用翻译键
{t('painRelief.title')}
const title = t('painRelief.title');
const temperature = t('medical.heatTherapy.temperature');
```

### 2. 统一翻译键管理
**所有文本内容必须通过翻译键管理**

```typescript
// ✅ 正确的翻译键使用
const t = useTranslations('painRelief');
return <h1>{t('title')}</h1>;

// ✅ 命名空间使用
const t = useTranslations('medical');
return <p>{t('heatTherapy.description')}</p>;
```

## 🏗️ 翻译键命名规范

### 命名结构
```
[category].[subcategory].[item]
```

### 分类标准

#### 1. 页面级 (pages)
```
pages.[pageName].[section].[item]
```

**示例**：
```json
{
  "pages": {
    "naturalTherapies": {
      "hero": {
        "title": "自然疗法与平时调理",
        "subtitle": "温和的自然方法和生活方式调整"
      },
      "sections": {
        "holisticApproaches": {
          "title": "整体疗法",
          "description": "综合性的健康管理方法"
        }
      }
    }
  }
}
```

#### 2. 组件级 (components)
```
components.[componentName].[element]
```

**示例**：
```json
{
  "components": {
    "button": {
      "submit": "提交",
      "cancel": "取消",
      "loading": "加载中..."
    },
    "modal": {
      "title": "确认操作",
      "message": "您确定要执行此操作吗？"
    }
  }
}
```

#### 3. 通用级 (common)
```
common.[category].[item]
```

**示例**：
```json
{
  "common": {
    "actions": {
      "save": "保存",
      "edit": "编辑",
      "delete": "删除",
      "cancel": "取消"
    },
    "messages": {
      "loading": "加载中...",
      "error": "发生错误",
      "success": "操作成功"
    },
    "navigation": {
      "home": "首页",
      "about": "关于",
      "contact": "联系我们"
    }
  }
}
```

#### 4. 医学级 (medical)
```
medical.[category].[term]
```

**示例**：
```json
{
  "medical": {
    "symptoms": {
      "cramping": "痉挛",
      "bloating": "腹胀",
      "headache": "头痛"
    },
    "treatments": {
      "heatTherapy": {
        "temperature": "40-45°C (104-113°F)",
        "duration": "15-20分钟",
        "frequency": "按需使用，每日最多3-4次"
      },
      "medication": {
        "ibuprofen": "布洛芬",
        "dosage": "200-400mg",
        "timing": "疼痛开始时服用"
      }
    }
  }
}
```

## 🛠️ 开发工作流

### 1. 新页面开发流程

#### Step 1: 创建页面模板
```bash
# 生成页面模板
node scripts/hardcode-prevention-toolkit.js generate-template naturalTherapies
```

#### Step 2: 设计翻译键结构
```typescript
// 在 messages/zh.json 中添加
{
  "naturalTherapies": {
    "meta": {
      "title": "自然疗法与平时调理",
      "description": "温和的自然方法和生活方式调整"
    },
    "hero": {
      "title": "培养长期健康",
      "subtitle": "自然疗法与日常习惯的融合"
    }
  }
}
```

#### Step 3: 编写组件代码
```typescript
// 使用翻译键
const t = useTranslations('naturalTherapies');

export default function NaturalTherapiesPage() {
  return (
    <div>
      <h1>{t('hero.title')}</h1>
      <p>{t('hero.subtitle')}</p>
    </div>
  );
}
```

#### Step 4: 验证和测试
```bash
# 检查硬编码
node scripts/hardcode-prevention-toolkit.js detect

# 检查翻译键完整性
node scripts/hardcode-prevention-toolkit.js check-keys
```

### 2. 内容更新流程

#### Step 1: 更新翻译文件
```json
// 在 messages/zh.json 中更新
{
  "naturalTherapies": {
    "hero": {
      "title": "新的标题内容"
    }
  }
}
```

#### Step 2: 同步英文翻译
```json
// 在 messages/en.json 中同步
{
  "naturalTherapies": {
    "hero": {
      "title": "New Title Content"
    }
  }
}
```

#### Step 3: 验证更新
```bash
# 检查翻译键完整性
node scripts/hardcode-prevention-toolkit.js check-keys
```

## 🔍 质量检查清单

### 代码提交前检查
- [ ] 无硬编码字符串
- [ ] 所有翻译键已添加到JSON文件
- [ ] 中英文翻译内容完整
- [ ] 翻译键命名符合规范
- [ ] 医学术语使用准确
- [ ] 代码格式规范

### 内容更新检查
- [ ] 翻译键命名符合规范
- [ ] 中英文内容一致
- [ ] 医学内容准确性
- [ ] 用户体验友好
- [ ] 响应式设计适配

### 定期维护检查
- [ ] 清理未使用的翻译键
- [ ] 更新过时的内容
- [ ] 检查链接有效性
- [ ] 优化页面性能
- [ ] 验证多语言切换

## 🚫 禁止的做法

### 1. 硬编码文本
```typescript
// ❌ 禁止 - 条件硬编码
{locale === 'zh' ? '中文内容' : 'English content'}

// ❌ 禁止 - 直接字符串
const message = '欢迎使用我们的服务';

// ❌ 禁止 - 科学参数硬编码
const dosage = '200-400mg布洛芬';
```

### 2. 不规范的翻译键
```typescript
// ❌ 禁止 - 不规范的键名
t('title')  // 缺少命名空间
t('page-title')  // 使用连字符
t('PageTitle')  // 大小写不一致
```

### 3. 混合语言内容
```typescript
// ❌ 禁止 - 同一页面混合语言
<h1>Welcome to 我们的服务</h1>
<p>This is a 专业的健康平台</p>
```

## ✅ 推荐的做法

### 1. 使用翻译键
```typescript
// ✅ 推荐 - 使用翻译键
const t = useTranslations('home');
return <h1>{t('welcome.title')}</h1>;
```

### 2. 规范的命名
```typescript
// ✅ 推荐 - 规范的键名
t('pages.home.hero.title')
t('components.button.submit')
t('common.actions.save')
t('medical.symptoms.cramping')
```

### 3. 类型安全
```typescript
// ✅ 推荐 - 类型安全的翻译键
type TranslationKeys = 'pages.home.hero.title' | 'common.actions.save';

const t = useTranslations<TranslationKeys>('home');
```

## 🛡️ 预防机制

### 1. 开发环境配置
```json
// .vscode/settings.json
{
  "i18n-ally.localesPaths": ["messages"],
  "i18n-ally.keystyle": "nested",
  "i18n-ally.namespace": true,
  "i18n-ally.pathMatcher": "{locale}.json",
  "i18n-ally.enabledParsers": ["json"],
  "i18n-ally.sourceLanguage": "en",
  "i18n-ally.displayLanguage": "zh"
}
```

### 2. Git Hooks
```bash
#!/bin/sh
# .git/hooks/pre-commit

echo "🔍 检查硬编码..."
node scripts/hardcode-prevention-toolkit.js detect

if [ $? -ne 0 ]; then
  echo "❌ 发现硬编码，请修复后重新提交"
  exit 1
fi

echo "✅ 硬编码检查通过"
```

### 3. CI/CD 集成
```yaml
# .github/workflows/i18n-check.yml
name: 国际化检查

on: [push, pull_request]

jobs:
  i18n-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: 安装依赖
        run: npm install
      - name: 检查硬编码
        run: node scripts/hardcode-prevention-toolkit.js detect
      - name: 检查翻译键完整性
        run: node scripts/hardcode-prevention-toolkit.js check-keys
```

## 📚 工具使用指南

### 硬编码检测
```bash
# 检测所有硬编码问题
node scripts/hardcode-prevention-toolkit.js detect

# 检测特定文件
node scripts/hardcode-prevention-toolkit.js detect app/pages/home.tsx
```

### 翻译键检查
```bash
# 检查翻译键完整性
node scripts/hardcode-prevention-toolkit.js check-keys

# 检查特定命名空间
node scripts/hardcode-prevention-toolkit.js check-keys pages
```

### 模板生成
```bash
# 生成页面模板
node scripts/hardcode-prevention-toolkit.js generate-template naturalTherapies

# 生成组件模板
node scripts/hardcode-prevention-toolkit.js generate-template button
```

## 🎯 最佳实践总结

1. **预防为主**：建立规范，从源头防止硬编码
2. **工具支持**：使用自动化工具检测和修复
3. **质量保证**：建立完整的检查和验证流程
4. **持续改进**：定期优化和更新规范
5. **团队协作**：确保所有开发者遵循规范

通过遵循这套规范，可以确保项目的国际化质量和可维护性，避免硬编码问题的产生。
